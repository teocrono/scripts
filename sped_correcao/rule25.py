# arruma produtos monofÃ¡sicos

def exec(conexao):

    cursor = conexao.cursor()

    print("RULE 25 - Inicializando",end=' ')

    select = "select r0 from principal where r1 = \"C180\" and r5 in (4119,4713,17510,22541,11213,11215,11350,11856,16259,16975,18535,18977,16707,16710,21436,7492,7494,7480,7481,7482,7473,10860,10943,11717,11830,11726,11728,11748,11838,11845,11847,11827,11761,12878,12883,12885,12887,12891,12895,15001,15552,17196,18147,19744,19747,21811,21813,21825,26997,27156,27223,29289,30791,30804,30808,30809,30819,30820,34205,40798,40801,40802,40804,40825,2464,4702,11212,11757,18976,17517,18981,16977,23183,7471,7472,10632,11828,11718,11829,11834,11722,11727,11807,11749,11815,11817,11819,11843,11850,11825,12881,12890,13153,13253,15550,15553,16733,17061,17511,17512,18984,19580,21818,23797,24537,26382,26457,30801,30802,30812,30815,30816,34052,34056,40795,40796,40819,40822,40805,40823,40810,40790,40812,40830,40816,11209,11210,11277,11285,16355,21437,7479,7770,11713,11714,11836,11750,11839,11844,11848,11759,12882,13154,14191,15554,17062,17509,18148,21809,21810,21821,21822,21824,26419,26420,26381,30796,30797,33461,32721,34054,40794,40818,40824,40813,40831,2132,9276,11214,11216,11857,11837,11739,11853,16258,16976,16468,18979,18985,18973,22283,7477,10728,10918,11723,11730,11809,11811,11812,11816,11818,11746,11747,11821,11822,11823,11824,11826,11760,12892,13156,15000,16486,18982,19746,21814,21815,21816,23259,26383,28503,27465,30813,33460,34055,40820,40800,40807,40809,40826,8009,4699,4708,11207,11275,11278,11854,11754,11755,11758,16257,18271,18980,18983,16709,21318,7478,7476,7495,848,11792,11831,11833,11731,11732,11808,11810,11751,11752,11745,11846,14232,16654,17513,17515,18149,21433,21324,21807,21817,21820,21828,23877,26418,26379,28506,30798,30817,34057,40793,40797,40803,40828,40811,40814,40815,40817,22284,11211,11279,11280,11625,11738,16708,16711,16712,16978,16256,21434,21438,7497,7499,7491,7470,7769,10627,10919,10920,10817,11813,12732,12884,12893,12894,13155,14233,15376,19733,21812,21819,21823,23350,23558,26455,28507,28509,30790,30795,30806,30811,30814,34068,34069,34053,40821,40806,40792,2131,17508,11208,11276,11852,17389,18978,16706,16713,21439,23184,7498,7493,10825,10826,10828,11439,11715,11832,11835,11729,11840,11820,12740,12879,13157,13254,14234,15549,17481,17514,18146,18974,19734,19745,23528,24136,26996,26378,27099,28504,28505,28502,28313,30792,30794,30799,30800,30803,30810,30818,40799,40808,40791,40829,4118,12003,11217,11842,18975,17518,16470,21435,7490,7496,10633,10733,10827,10858,11716,11814,11841,11849,11851,12733,12880,12886,12888,12889,12963,15551,15751,17608,18154,20918,21761,21826,24022,26607,26380,27014,27155,28508,30793,30805,30807,33459,33437,40827) "
    select = cursor.execute(select)
    select = select.fetchall()
    ids = [i[0] for i in select]

    for i in ids:
        ini = i

        select = "SELECT min(r0) FROM principal WHERE r1 = \"C180\" AND r0 > " + str(i)
        select = cursor.execute(select)
        fim = select.fetchone()[0]

        if fim == None:
            fim = ini + 1000

        update = " UPDATE principal SET "
        update = update + " r2 = \"07\", "
        update = update + " r6 = \"0,00\", "
        update = update + " r7 = \"0,0000\", "
        update = update + " r10 = \"0,00\" "
        update = update + " WHERE 1=1 "
        update = update + " AND r0 between " + str(ini) + " and " + str(fim) + " "
        update = update + " AND r1 in (\"C181\",\"C185\")"
        cursor.execute(update)
        conexao.commit()

    print('-',end=' ')
    print("Finalizado")







    select = "select r0 from principal where r1 = \"C190\" and r5 in (4119,4713,17510,22541,11213,11215,11350,11856,16259,16975,18535,18977,16707,16710,21436,7492,7494,7480,7481,7482,7473,10860,10943,11717,11830,11726,11728,11748,11838,11845,11847,11827,11761,12878,12883,12885,12887,12891,12895,15001,15552,17196,18147,19744,19747,21811,21813,21825,26997,27156,27223,29289,30791,30804,30808,30809,30819,30820,34205,40798,40801,40802,40804,40825,2464,4702,11212,11757,18976,17517,18981,16977,23183,7471,7472,10632,11828,11718,11829,11834,11722,11727,11807,11749,11815,11817,11819,11843,11850,11825,12881,12890,13153,13253,15550,15553,16733,17061,17511,17512,18984,19580,21818,23797,24537,26382,26457,30801,30802,30812,30815,30816,34052,34056,40795,40796,40819,40822,40805,40823,40810,40790,40812,40830,40816,11209,11210,11277,11285,16355,21437,7479,7770,11713,11714,11836,11750,11839,11844,11848,11759,12882,13154,14191,15554,17062,17509,18148,21809,21810,21821,21822,21824,26419,26420,26381,30796,30797,33461,32721,34054,40794,40818,40824,40813,40831,2132,9276,11214,11216,11857,11837,11739,11853,16258,16976,16468,18979,18985,18973,22283,7477,10728,10918,11723,11730,11809,11811,11812,11816,11818,11746,11747,11821,11822,11823,11824,11826,11760,12892,13156,15000,16486,18982,19746,21814,21815,21816,23259,26383,28503,27465,30813,33460,34055,40820,40800,40807,40809,40826,8009,4699,4708,11207,11275,11278,11854,11754,11755,11758,16257,18271,18980,18983,16709,21318,7478,7476,7495,848,11792,11831,11833,11731,11732,11808,11810,11751,11752,11745,11846,14232,16654,17513,17515,18149,21433,21324,21807,21817,21820,21828,23877,26418,26379,28506,30798,30817,34057,40793,40797,40803,40828,40811,40814,40815,40817,22284,11211,11279,11280,11625,11738,16708,16711,16712,16978,16256,21434,21438,7497,7499,7491,7470,7769,10627,10919,10920,10817,11813,12732,12884,12893,12894,13155,14233,15376,19733,21812,21819,21823,23350,23558,26455,28507,28509,30790,30795,30806,30811,30814,34068,34069,34053,40821,40806,40792,2131,17508,11208,11276,11852,17389,18978,16706,16713,21439,23184,7498,7493,10825,10826,10828,11439,11715,11832,11835,11729,11840,11820,12740,12879,13157,13254,14234,15549,17481,17514,18146,18974,19734,19745,23528,24136,26996,26378,27099,28504,28505,28502,28313,30792,30794,30799,30800,30803,30810,30818,40799,40808,40791,40829,4118,12003,11217,11842,18975,17518,16470,21435,7490,7496,10633,10733,10827,10858,11716,11814,11841,11849,11851,12733,12880,12886,12888,12889,12963,15551,15751,17608,18154,20918,21761,21826,24022,26607,26380,27014,27155,28508,30793,30805,30807,33459,33437,40827) "
    select = cursor.execute(select)
    select = select.fetchall()
    ids = [i[0] for i in select]

    for i in ids:
        ini = i

        select = "SELECT min(r0) FROM principal WHERE r1 = \"C190\" AND r0 > " + str(i)
        select = cursor.execute(select)
        fim = select.fetchone()[0]

        if fim == None:
            fim = ini + 1000

        update = " UPDATE principal SET "
        update = update + " r3 = \"71\", "
        update = update + " r7 = \"0,00\", "
        update = update + " r8 = \"0,0000\", "
        update = update + " r11 = \"0,00\" "
        update = update + " WHERE 1=1 "
        update = update + " AND r0 between " + str(ini) + " and " + str(fim) + " "
        update = update + " AND r1 in (\"C191\",\"C195\")"
        cursor.execute(update)
        conexao.commit()

    print('-',end=' ')
    print("Finalizado")